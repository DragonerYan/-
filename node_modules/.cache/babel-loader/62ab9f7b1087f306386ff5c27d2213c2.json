{"remainingRequest":"D:\\github007\\vue2-element-touzi-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\github007\\vue2-element-touzi-admin\\src\\store\\modules\\permission.js","dependencies":[{"path":"D:\\github007\\vue2-element-touzi-admin\\src\\store\\modules\\permission.js","mtime":1604132537178},{"path":"D:\\github007\\vue2-element-touzi-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\github007\\vue2-element-touzi-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport { asyncRouterMap, constantRouterMap } from '@/router';\nimport { topRouterMap } from \"@/router/topRouter\";\nimport * as mutils from '@/utils/mUtils'; // 循环追加顶栏菜单\n\nfunction addTopRouter() {\n  asyncRouterMap.forEach(function (item) {\n    if (item.children && item.children.length >= 1) {\n      item.children.forEach(function (sitem) {\n        topRouterMap.forEach(function (citem) {\n          if (sitem.name === citem.parentName) {\n            var newChildren = item.children.concat(citem.topmenulist); // arr\n\n            item.children = newChildren;\n          }\n        });\n      });\n    }\n  });\n  return asyncRouterMap;\n} // 获取到当前路由对应顶部子菜单\n\n\nfunction filterTopRouters(data) {\n  var topRouters = topRouterMap.find(function (item) {\n    return item.parentName === data.name;\n  });\n\n  if (!mutils.isEmpty(topRouters)) {\n    return topRouters.topmenulist;\n  }\n}\n/**\r\n * 通过meta.role判断是否与当前用户权限匹配\r\n * @param roles\r\n * @param route\r\n */\n\n\nfunction hasPermission(roles, route) {\n  // roles为权限身份数组\n  if (route.meta && route.meta.roles) {\n    return roles.some(function (role) {\n      return route.meta.roles.indexOf(role) >= 0;\n    });\n  } else {\n    return true;\n  }\n}\n/**\r\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\r\n * @param asyncRouterMap\r\n * @param roles\r\n */\n\n\nfunction filterAsyncRouter(asyncRouterMap, roles) {\n  // 返回满足条件的子路由对象\n  var accessedRouters = asyncRouterMap.filter(function (route) {\n    if (hasPermission(roles, route)) {\n      if (route.children && route.children.length) {\n        // route.children重新过滤赋值;\n        route.children = filterAsyncRouter(route.children, roles);\n      }\n\n      return true; // 返回该权限路由对象;\n    }\n\n    return false;\n  });\n  return accessedRouters;\n}\n\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: [],\n    topRouters: [],\n    topTitle: '',\n    menuIndex: 0\n  },\n  getters: {\n    permission_routers: function permission_routers(state) {\n      return state.routers;\n    },\n    // 所有路由\n    addRouters: function addRouters(state) {\n      return state.addRouters;\n    },\n    // 权限过滤路由\n    topRouters: function topRouters(state) {\n      return state.topRouters;\n    },\n    // 顶部三级路由\n    topTitle: function topTitle(state) {\n      return state.topTitle;\n    },\n    // 顶部的title\n    menuIndex: function menuIndex(state) {\n      return state.menuIndex;\n    } // 顶部菜单的index\n\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, routers) {\n      state.addRouters = routers; // 权限路由\n\n      state.routers = constantRouterMap.concat(routers); // 总路由\n    },\n    CLICK_INNER_LEFT_MENU: function CLICK_INNER_LEFT_MENU(state, data) {\n      // titleList:arr\n      state.topRouters = data.titleList;\n    },\n    CLICK_TOP_MENU: function CLICK_TOP_MENU(state, data) {\n      state.topTitle = data.title;\n      state.menuIndex = data.menuIndex;\n    }\n  },\n  actions: {\n    // 根据角色，重新设置权限路由;并保存到vuex中,SET_ROUTERS;\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve) {\n        var roles = data.roles;\n        var accessedRouters = '';\n\n        if (roles.indexOf('admin') >= 0) {\n          // 如果是管理员，直接将权限路由赋值给新路由;\n          accessedRouters = asyncRouterMap;\n        } else {\n          // 非管理员用户,如roles:['editor','developer']，则需要过滤权限路由数据\n          accessedRouters = filterAsyncRouter(asyncRouterMap, roles);\n        }\n\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    },\n    ClickLeftInnerMenu: function ClickLeftInnerMenu(_ref2, data) {\n      var commit = _ref2.commit;\n      commit('CLICK_INNER_LEFT_MENU', data);\n    },\n    ClickTopMenu: function ClickTopMenu(_ref3, data) {\n      var commit = _ref3.commit;\n      commit('CLICK_TOP_MENU', data);\n    }\n  }\n};\nexport default permission;",{"version":3,"sources":["D:\\github007\\vue2-element-touzi-admin\\src\\store\\modules\\permission.js"],"names":["asyncRouterMap","constantRouterMap","topRouterMap","mutils","addTopRouter","forEach","item","children","length","sitem","citem","name","parentName","newChildren","concat","topmenulist","filterTopRouters","data","topRouters","find","isEmpty","hasPermission","roles","route","meta","some","role","indexOf","filterAsyncRouter","accessedRouters","filter","permission","state","routers","addRouters","topTitle","menuIndex","getters","permission_routers","mutations","SET_ROUTERS","CLICK_INNER_LEFT_MENU","titleList","CLICK_TOP_MENU","title","actions","GenerateRoutes","commit","Promise","resolve","ClickLeftInnerMenu","ClickTopMenu"],"mappings":"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","sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/router'\r\nimport { topRouterMap } from \"@/router/topRouter\";\r\nimport * as mutils from '@/utils/mUtils'\r\n\r\n\r\n\r\n// 循环追加顶栏菜单\r\nfunction addTopRouter(){\r\n  asyncRouterMap.forEach( (item) => {\r\n    if(item.children && item.children.length >= 1){\r\n      item.children.forEach((sitem) => {\r\n       topRouterMap.forEach((citem) => {\r\n          if(sitem.name === citem.parentName){\r\n              let newChildren = item.children.concat(citem.topmenulist); // arr\r\n              item.children = newChildren;\r\n          }\r\n       })\r\n      })\r\n    }\r\n  })\r\n  return asyncRouterMap;\r\n}\r\n\r\n // 获取到当前路由对应顶部子菜单\r\n function filterTopRouters(data){\r\n    let topRouters = topRouterMap.find((item)=>{\r\n       return item.parentName === data.name\r\n    })\r\n    if(!mutils.isEmpty(topRouters)){\r\n       return topRouters.topmenulist;\r\n    }\r\n}\r\n\r\n/**\r\n * 通过meta.role判断是否与当前用户权限匹配\r\n * @param roles\r\n * @param route\r\n */\r\nfunction hasPermission(roles, route) {\r\n  // roles为权限身份数组\r\n  if (route.meta && route.meta.roles) {\r\n    return roles.some(role => route.meta.roles.indexOf(role) >= 0)\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\n/**\r\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\r\n * @param asyncRouterMap\r\n * @param roles\r\n */\r\nfunction filterAsyncRouter(asyncRouterMap, roles) {\r\n  // 返回满足条件的子路由对象\r\n  const accessedRouters = asyncRouterMap.filter(route => {\r\n    if (hasPermission(roles, route)) {\r\n      if (route.children && route.children.length) {\r\n        // route.children重新过滤赋值;\r\n        route.children = filterAsyncRouter(route.children, roles)\r\n      }\r\n      return true // 返回该权限路由对象;\r\n    }\r\n    return false\r\n  })\r\n  return accessedRouters\r\n}\r\n\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: [],\r\n    topRouters:[],\r\n    topTitle:'',\r\n    menuIndex:0\r\n  },\r\n  getters:{\r\n    permission_routers: state => state.routers, // 所有路由\r\n    addRouters: state => state.addRouters,  // 权限过滤路由\r\n    topRouters: state => state.topRouters,  // 顶部三级路由\r\n    topTitle:state => state.topTitle, // 顶部的title\r\n    menuIndex:state => state.menuIndex, // 顶部菜单的index\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, routers) => {\r\n      state.addRouters = routers // 权限路由\r\n      state.routers = constantRouterMap.concat(routers) // 总路由\r\n    },\r\n    CLICK_INNER_LEFT_MENU:(state,data) => { // titleList:arr\r\n        state.topRouters = data.titleList;\r\n    },\r\n    CLICK_TOP_MENU:(state,data) => {\r\n      state.topTitle = data.title\r\n      state.menuIndex = data.menuIndex\r\n\r\n    },\r\n  },\r\n  actions: {\r\n    // 根据角色，重新设置权限路由;并保存到vuex中,SET_ROUTERS;\r\n    GenerateRoutes({ commit }, data) {\r\n      return new Promise(resolve => {\r\n        let roles = data.roles;\r\n        let accessedRouters = '';\r\n        if (roles.indexOf('admin') >= 0) {\r\n          // 如果是管理员，直接将权限路由赋值给新路由;\r\n          accessedRouters = asyncRouterMap\r\n        } else {\r\n          // 非管理员用户,如roles:['editor','developer']，则需要过滤权限路由数据\r\n          accessedRouters = filterAsyncRouter(asyncRouterMap, roles)\r\n        }\r\n        commit('SET_ROUTERS', accessedRouters)\r\n        resolve()\r\n      })\r\n    },\r\n    ClickLeftInnerMenu({ commit },data) {\r\n      commit('CLICK_INNER_LEFT_MENU',data)\r\n    },\r\n    ClickTopMenu({ commit },data) {\r\n      commit('CLICK_TOP_MENU',data)\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"]}]}